{"id":"unicode-substring","title":"Unicode substring","date":"2018-09-06T06:46:40.741Z","tags":["JavaScript"],"index":false,"draft":false,"html":"<p>æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šåœ¨åšå­—ç¬¦ä¸²æˆªå–æ“ä½œæ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«äº† emoji å­—ç¬¦ï¼ˆä¸€ä¸ªè¡¨æƒ…å å¤šä¸ª unicode å­—ç¬¦ï¼‰ï¼Œè€Œç¢°å·§åˆæŠŠå®ƒæˆªæ–­äº†ï¼Œç¨‹åºä¼šå‡ºé”™ã€‚åœ¨ ReactNative App ä¸‹çš„å…·ä½“è¡¨ç°å°±æ˜¯å´©æºƒã€‚ç”±äºä»¥å‰åšçš„æ˜¯ç½‘é¡µæ¯”è¾ƒå¤šï¼ŒåŸºæœ¬æ²¡æœ‰è¾“å…¥è¡¨æƒ…å­—ç¬¦çš„æ¡ˆä¾‹ï¼Œè€Œåœ¨æ‰‹æœºä¸Šå°±ä¸ä¸€æ ·äº†ï¼Œå› æ­¤è¿™ä¸ªé—®é¢˜è¿˜æ˜¯ç¬¬ä¸€æ¬¡å‘ç°ã€‚</p>\n<p>æ¯”å¦‚è¯´ï¼š</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-string\">'ğŸ˜‹EmojiğŸ˜‹'</span>.substring(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">2</span>) <span class=\"hljs-comment\">// ğŸ˜‹</span>\n</code></pre>\n<p>å› æ­¤ï¼Œå¦‚æœå¯¹è¿™ä¸ªå­—ç¬¦ä¸²åš <code>substring(0, 1)</code> æ“ä½œï¼Œå°±ä¼šæˆªå–åˆ°ä¸€ä¸ªæœªçŸ¥å­—ç¬¦ã€‚</p>\n<!-- more -->\n<p>ä¸­é—´çš„æ¢ç´¢è¿‡ç¨‹å°±ä¸è°ˆäº†ï¼ŒGoogle äº†ä¸€ä¸‹è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠå’¨è¯¢åŒäº‹ä»¬ä»¥åï¼Œå‘ç°æœ€ç®€å•çš„åŠæ³•æ˜¯é€šè¿‡ <code>lodash</code> è‡ªå¸¦çš„ <code>toArray</code> æ–¹æ³•ï¼Œå…ˆå°†å®ƒè½¬ä¸ºæ•°ç»„ï¼Œç„¶åå°†æ•´ä¸ªé€»è¾‘æ”¹ä¸ºæ•°æ®çš„æˆªå–æ“ä½œï¼Œæœ€åå†è½¬å›å­—ç¬¦ä¸²ã€‚</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">safeSubStr</span> (<span class=\"hljs-params\">str, start, end</span>) </span>{\n  <span class=\"hljs-keyword\">const</span> charArr = _.toArray(str);\n  <span class=\"hljs-keyword\">return</span> _.slice(charArr, start, end).join(<span class=\"hljs-string\">''</span>);\n}\n</code></pre>\n<p>å®é™…ä¸Šè§£å†³é—®é¢˜çš„æ˜¯ <code>_.toArray</code>ï¼Œå®ƒå¸®æˆ‘ä»¬æŠŠè¡¨æƒ…å­—ç¬¦æ­£ç¡®åœ°æˆªäº†å‡ºæ¥ï¼š</p>\n<pre><code class=\"language-javascript\">_.toArray(<span class=\"hljs-string\">'ğŸ˜‹EmojiğŸ˜‹'</span>) <span class=\"hljs-comment\">// [\"ğŸ˜‹\", \"E\", \"m\", \"o\", \"j\", \"i\", \"ğŸ˜‹\"]</span>\n</code></pre>\n<p>å…¶å®æˆ‘ä¹Ÿæ¯”è¾ƒå¥½å¥‡å®ƒæ˜¯æ€ä¹ˆåšçš„ï¼Œé€šè¿‡è§‚å¯Ÿæºç ï¼Œå‘ç°äº†çœŸæ­£çš„è§£å†³æ–¹æ¡ˆï¼š</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">// lodash/_unicodeToArray.js</span>\n<span class=\"hljs-comment\">/** Used to compose unicode character classes. */</span>\n<span class=\"hljs-keyword\">var</span> rsAstralRange = <span class=\"hljs-string\">'\\\\ud800-\\\\udfff'</span>,\n    rsComboMarksRange = <span class=\"hljs-string\">'\\\\u0300-\\\\u036f'</span>,\n    reComboHalfMarksRange = <span class=\"hljs-string\">'\\\\ufe20-\\\\ufe2f'</span>,\n    rsComboSymbolsRange = <span class=\"hljs-string\">'\\\\u20d0-\\\\u20ff'</span>,\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = <span class=\"hljs-string\">'\\\\ufe0e\\\\ufe0f'</span>;\n\n<span class=\"hljs-comment\">/** Used to compose unicode capture groups. */</span>\n<span class=\"hljs-keyword\">var</span> rsAstral = <span class=\"hljs-string\">'['</span> + rsAstralRange + <span class=\"hljs-string\">']'</span>,\n    rsCombo = <span class=\"hljs-string\">'['</span> + rsComboRange + <span class=\"hljs-string\">']'</span>,\n    rsFitz = <span class=\"hljs-string\">'\\\\ud83c[\\\\udffb-\\\\udfff]'</span>,\n    rsModifier = <span class=\"hljs-string\">'(?:'</span> + rsCombo + <span class=\"hljs-string\">'|'</span> + rsFitz + <span class=\"hljs-string\">')'</span>,\n    rsNonAstral = <span class=\"hljs-string\">'[^'</span> + rsAstralRange + <span class=\"hljs-string\">']'</span>,\n    rsRegional = <span class=\"hljs-string\">'(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}'</span>,\n    rsSurrPair = <span class=\"hljs-string\">'[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]'</span>,\n    rsZWJ = <span class=\"hljs-string\">'\\\\u200d'</span>;\n\n<span class=\"hljs-comment\">/** Used to compose unicode regexes. */</span>\n<span class=\"hljs-keyword\">var</span> reOptMod = rsModifier + <span class=\"hljs-string\">'?'</span>,\n    rsOptVar = <span class=\"hljs-string\">'['</span> + rsVarRange + <span class=\"hljs-string\">']?'</span>,\n    rsOptJoin = <span class=\"hljs-string\">'(?:'</span> + rsZWJ + <span class=\"hljs-string\">'(?:'</span> + [rsNonAstral, rsRegional, rsSurrPair].join(<span class=\"hljs-string\">'|'</span>) + <span class=\"hljs-string\">')'</span> + rsOptVar + reOptMod + <span class=\"hljs-string\">')*'</span>,\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsSymbol = <span class=\"hljs-string\">'(?:'</span> + [rsNonAstral + rsCombo + <span class=\"hljs-string\">'?'</span>, rsCombo, rsRegional, rsSurrPair, rsAstral].join(<span class=\"hljs-string\">'|'</span>) + <span class=\"hljs-string\">')'</span>;\n\n<span class=\"hljs-comment\">/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */</span>\n<span class=\"hljs-keyword\">var</span> reUnicode = <span class=\"hljs-built_in\">RegExp</span>(rsFitz + <span class=\"hljs-string\">'(?='</span> + rsFitz + <span class=\"hljs-string\">')|'</span> + rsSymbol + rsSeq, <span class=\"hljs-string\">'g'</span>);\n\n<span class=\"hljs-comment\">/**\n * Converts a Unicode `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">unicodeToArray</span>(<span class=\"hljs-params\">string</span>) </span>{\n  <span class=\"hljs-keyword\">return</span> string.match(reUnicode) || [];\n}\n\n<span class=\"hljs-built_in\">module</span>.exports = unicodeToArray;\n</code></pre>\n<p>ä¸€å¤§å †æ­£åˆ™å°±ä¸è°ˆäº†ï¼Œä¹Ÿä¸çŸ¥é“å®ƒæ˜¯ä»å“ªé‡Œæ‰¾æ¥çš„è¿™äº›å€¼ï¼Œæœ€åç»„è£…äº†ä¸€ä¸ª <code>reUnicode</code> æ­£åˆ™æ¥å®ç° unicode è½¬æ•°ç»„ã€‚è¯åˆè¯´å›æ¥ï¼Œè¿™ä¹ˆåšä¼šä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜å‘¢ï¼Ÿæˆ‘è¡¨ç¤ºæ¯”è¾ƒæ‹…å¿§ã€‚å¥½åœ¨é¡¹ç›®é‡Œé¢éœ€è¦è¿™ä¹ˆåšçš„åœºæ™¯ä¸å¤šï¼Œå­—ç¬¦ä¸²ä¹Ÿä¸é•¿ï¼Œå¯ä»¥å¦‚æ­¤æš´åŠ›è§£å†³ã€‚å¦‚æœæ¢ä¸ªåœºæ™¯ï¼Œè¿˜çœŸä¸å¥½è¯´ã€‚ä¹Ÿè®¸åˆéœ€è¦ä¸€ç§æ›´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆäº†ã€‚</p>\n"}