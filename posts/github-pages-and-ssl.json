{"id":"github-pages-and-ssl","title":"Github Pages and SSL","date":"2016-12-08T17:00:00.000Z","categories":["Personal"],"tags":["Github","SSL"],"html":"<p>经过一些努力，把博客迁移到了 Github Pages，将域名改成了自定义，并且成功启用了 SSL，以下是步骤（就不截图了）。</p>\n<h2 id=\"\">部署代码 <a class=\"header-anchor\" href=\"#\" aria-hidden=\"true\">&#128279;</a></h2>\n<p>Github Pages 支持两种级别的部署：</p>\n<ol>\n<li><strong>user / organization</strong> 方式\n<ul>\n<li>repo 名字必须为 <code>&lt;user-name or org-name&gt;.github.io</code></li>\n<li>pages build branch 固定为 <code>master</code></li>\n<li>部署后的发布域名即为 repo 名</li>\n</ul>\n</li>\n<li><strong>project</strong> 方式\n<ul>\n<li>repo 名字没有限制</li>\n<li>pages build branch 可以任意指定</li>\n<li>发布域名为 <code>&lt;user-name or org-name&gt;.github.io/&lt;project-name&gt;</code></li>\n</ul>\n</li>\n</ol>\n<p>因此，如果要做个人页面则必然选择第一种方式。</p>\n<p>因为 build branch 限制为 master，因此我一开始选择了重建 repo，实际上没有必要，可以直接 rename 旧的 repo</p>\n<p>rename 后，到 repo settings -&gt; options -&gt; Github Pages，即可发现自动部署已经开始了。即刻访问 <code>&lt;user-name or org-name&gt;.github.io</code> 可以看到部署结果。</p>\n<h2 id=\"-2\">自定义域名 <a class=\"header-anchor\" href=\"#-2\" aria-hidden=\"true\">&#128279;</a></h2>\n<ol>\n<li>在 repo settings -&gt; options -&gt; Github Pages -&gt; Custom Domain 中，填入自己的域名，如 <code>wxsm.space</code>，保存</li>\n<li>在自己的域名供应商处修改域名解析，添加两条 A 记录（此处可以参考最新<a href=\"https://help.github.com/articles/setting-up-an-apex-domain/\">文档</a>）：\n<ul>\n<li><code>192.30.252.153</code></li>\n<li><code>192.30.252.154</code></li>\n</ul>\n</li>\n<li>等待记录生效</li>\n</ol>\n<p>过一会就可以发现，使用自定义域名可以访问网站了，并且原 <code>&lt;user-name or org-name&gt;.github.io</code> 会重定向到自定义域名。</p>\n<h2 id=\"ssl\">启用 SSL <a class=\"header-anchor\" href=\"#ssl\" aria-hidden=\"true\">&#128279;</a></h2>\n<p>这里是最麻烦的。虽然 Github Pages 原生支持 SSL，但是只针对 <code>*.github.io</code> 域名，对于自定义域名，无法直接启用。因此需要找一个支持 SSL 的 CDN 供应商。考虑到免费这个关键因素，选择了 CloudFlare（以下简称 CF）</p>\n<ol>\n<li>前往 CF 官网，注册账号，填入自己的域名，点几个 Continue</li>\n<li>到注册的最后一步时，需要将域名的 DNS 服务器切换为 CF 服务器（CF 会提供两个，两个都要填上），到原域名供应商处修改域名 DNS 服务器即可，24 小时内生效</li>\n<li>生效后可以打开网站查看是否正常。控制台页面上方有一个 Crypto Tab，点开，SSL 选择 <code>Flexible</code> 或者 <code>Full</code>，同样需要等待一段时间生效</li>\n<li>生效后即可以通过 <code>https</code> 访问网站了，如果需要强制 SSL，可以到 Page Rules Tab，添加一些记录，为某些域名段设置强制 SSL <code>Aways use https</code></li>\n</ol>\n","full":true}