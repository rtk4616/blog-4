<!DOCTYPE html><html class="nprogress-busy"><head><meta charset="utf-8"><meta name="google-site-verification" content="ekuL5J7xK1IdFtP13v3KxpuGKnYS1oCT9PvZdjYm8Eg"><meta name="viewport" content="user-scalable=no,width=device-width,initial-scale=1,maximum-scale=1"><link rel="shortcut icon" type="image/png" href="/static/favicon.png"><link rel="apple-touch-icon" sizes="200x200" href="/static/favicon-iphone.png"><title>wxsm's space - Egret Note</title><meta name="description" content="wxsms's personal blog."><meta name="keywords" content="Blog,JavaScript,HTML,CSS,Vue,Bootstrap"><link href="/static/css/app.c460d3b13d6d7ce0c63faa74a9023a8f.css" rel="stylesheet"><script type="text/javascript" src="/static/js/manifest.68263eefe155d055bfa0.js"></script><script type="text/javascript" src="/static/js/vendor.19a2875ac58b9bf76cc9.js"></script><script type="text/javascript" src="/static/js/app.6317672e36f60ab5ad32.js"></script><script async="" src="https://www.google-analytics.com/analytics.js" charset="utf8"></script><script async="" src="https://www.google-analytics.com/analytics.js" charset="utf8"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/0.24af7fe1e27d3b16bd28.js"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/4.f6eaab3002dc8add016f.js"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/0.24af7fe1e27d3b16bd28.js"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/1.3d038e42bb029d58fb1c.js"></script><script type="text/javascript" async="" id="embed-disqus" data-timestamp="1539144386501" src="//wxsm.disqus.com/embed.js"></script></head><body><section id="app"><section data-v-6a2c05ce="" style="display: none;"></section> <aside data-v-0044a876="" class=""><div data-v-0044a876="" class="brand"><h4 data-v-0044a876="" class="brand-link"><a data-v-0044a876="" href="/" class="router-link-active">wxsm's space</a></h4></div> <div data-v-0044a876="" class="search-container"><form data-v-e01410e2="" data-v-0044a876="" class="form-inline search-form-box"><div data-v-e01410e2="" class="form-group"><input data-v-e01410e2="" type="search" placeholder="Search..." required="required" minlength="2" class="form-control"></div></form></div> <div data-v-0044a876="" class="nav-container"><div data-v-0044a876="" class="nav-div"><ul data-v-0044a876="" role="tablist" class="nav nav-pills nav-stacked"><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/p" class="router-link-active btn btn-link" role="button">Archive</a></li><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/t" class="btn btn-link" role="button">Tags</a></li><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/g" class="btn btn-link" role="button">Guestbook</a></li><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/a" class="btn btn-link" role="button">About</a></li></ul></div> <div data-v-0044a876="" class="toc-div"><ul data-v-d065e12c="" data-v-0044a876="" class="toc-ul"><li data-v-d065e12c=""><a data-v-d065e12c="" href="#"><b data-v-d065e12c="">显示对象 </b></a> <ul data-v-d065e12c=""><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-2">对象树 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-3">对象类型 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-4">基本概念 </a></li></ul></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-9"><b data-v-d065e12c="">对象容器 </b></a> <ul data-v-d065e12c=""><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-10">深度管理 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-11">子对象选择 </a></li></ul></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-12"><b data-v-d065e12c="">矢量绘图 </b></a> <ul data-v-d065e12c=""><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-13">基本图形 </a></li></ul></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-19"><b data-v-d065e12c="">遮罩 </b></a> <!----></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-20"><b data-v-d065e12c="">碰撞检测 </b></a> <!----></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-21"><b data-v-d065e12c="">文本 </b></a> <ul data-v-d065e12c=""><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-22">样式 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-23">事件与链接 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-24">文本输入 </a></li></ul></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-25"><b data-v-d065e12c="">事件处理 </b></a> <ul data-v-d065e12c=""><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-26">执行流程 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-27">事件类 </a></li><li data-v-d065e12c=""><a data-v-d065e12c="" href="#-28">监听器 </a></li></ul></li></ul></div></div></aside> <section data-v-79039cdb="" class="page"><div data-v-79039cdb="" class="page-body"><button data-v-01aba251="" data-v-79039cdb="" type="button" class="navbar-toggle collapsed"><span data-v-01aba251="" class="sr-only">Toggle navigation</span> <span data-v-01aba251="" class="icon-bar"></span> <span data-v-01aba251="" class="icon-bar"></span> <span data-v-01aba251="" class="icon-bar"></span></button> <div data-v-79039cdb="" class="container-fluid"><div data-v-79039cdb="" class="row"><div data-v-79039cdb="" class="col-xs-12"><section data-v-f233b600="" data-v-79039cdb=""><h1 data-v-f233b600="">Egret Note</h1> <section data-v-f233b600="" id="post-content"><section data-v-19e352bd="" data-v-f233b600=""><div data-v-19e352bd="" class="meta-block"><i data-v-19e352bd="" class="glyphicon glyphicon-calendar"></i> <span data-v-19e352bd="">February 22, 2017</span></div> <div data-v-19e352bd="" class="meta-block"><a data-v-3cd447cb="" data-v-19e352bd="" href="/t#Egret-Engine" class="label-tag"><span data-v-3cd447cb="" class="label label-info">Egret-Engine</span></a></div></section> <div data-v-f233b600=""><p>Egret Engine 的学习笔记。</p>
<p>Egret Engine 是一款基于 JavaScript 的游戏制作引擎，支持 2D 与 3D 模式，支持 Canvas 与 WebGL 渲染，目前使用 TypeScript 编写。</p>
<!--more-->
<h2 id="">显示对象 <a class="header-anchor" href="#" aria-hidden="true">🔗</a></h2>
<p>“显示对象”，准确的含义是可以在舞台上显示的对象。可以显示的对象，既包括可以直接看见的图形、文字、视频、图片等，也包括不能看见但真实存在的显示对象容器。</p>
<p>在Egret中，视觉图形都是由显示对象和显示对象容器组成的。</p>
<h3 id="-2">对象树 <a class="header-anchor" href="#-2" aria-hidden="true">🔗</a></h3>
<ul>
<li>根：舞台 <code>DisplayObjectContainer:Stage</code></li>
<li>茎：主容器（文档类） <code>DisplayObjectContainer</code></li>
<li>树枝：容器 <code>DisplayObjectContainer</code></li>
<li>树叶：显示对象 <code>DisplayObject</code></li>
</ul>
<h3 id="-3">对象类型 <a class="header-anchor" href="#-3" aria-hidden="true">🔗</a></h3>
<ul>
<li><code>DisplayObject</code>	显示对象基类，所有显示对象均继承自此类</li>
<li><code>Bitmap</code>	位图，用来显示图片</li>
<li><code>Shape</code>	用来显示矢量图，可以使用其中的方法绘制矢量图形</li>
<li><code>TextField</code>	文本类</li>
<li><code>BitmapText</code>	位图文本类</li>
<li><code>DisplayObjectContainer</code>	显示对象容器接口，所有显示对象容器均实现此接口</li>
<li><code>Sprite</code>	带有矢量绘制功能的显示容器</li>
<li><code>Stage</code>	舞台类</li>
</ul>
<h3 id="-4">基本概念 <a class="header-anchor" href="#-4" aria-hidden="true">🔗</a></h3>
<p>二维坐标系。原点位于<strong>左上角</strong>。</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> shape:egret.Shape = <span class="hljs-keyword">new</span> egret.Shape();
shape.x = <span class="hljs-number">100</span>;
shape.y = <span class="hljs-number">20</span>;
</code></pre>
<p>支持的操作：</p>
<ul>
<li>alpha：透明度</li>
<li>width：宽度</li>
<li>height：高度</li>
<li>rotation：旋转角度</li>
<li>scaleX：横向缩放</li>
<li>scaleY：纵向缩放</li>
<li>skewX：横向斜切</li>
<li>skewY：纵向斜切</li>
<li>visible：是否可见</li>
<li>x：X 轴坐标值</li>
<li>y：Y 轴坐标值</li>
<li>anchorOffsetX：对象绝对锚点 X</li>
<li>anchorOffsetY：对象绝对锚点 Y</li>
</ul>
<h4 id="-5">锚点 <a class="header-anchor" href="#-5" aria-hidden="true">🔗</a></h4>
<p>Display Object 显示在舞台上的的位置需要通过 Anchor 来计算（初始值位于 Display Object 的左上角），可以通过 <code>anchorOffsetX</code> 和 <code>anchorOffsetY</code> 方法来改变对象的锚点（比如移至中点）。</p>
<h4 id="-6">定位 <a class="header-anchor" href="#-6" aria-hidden="true">🔗</a></h4>
<p>Display Object 的初始坐标为 <strong>(0, 0)</strong>，即位于<strong>容器的左上角</strong>（而非舞台）。</p>
<ul>
<li>相对于容器的位置可以类比作 <code>position: relative</code></li>
<li>相对于舞台的位置可以类比作 <code>position: absolute</code></li>
</ul>
<p>如果要获取绝对位置，需要调用 <code>container.globalToLocal(x, y)</code> 方法，参数代表舞台坐标，返回值为容器坐标。</p>
<p>至于 <code>z-index</code> 则跟 svg 的处理类似。</p>
<h4 id="-7">尺寸 <a class="header-anchor" href="#-7" aria-hidden="true">🔗</a></h4>
<p>两种方法更改尺寸：</p>
<ul>
<li>height / width</li>
<li>scaleX / scaleY</li>
</ul>
<h4 id="-8">斜切 <a class="header-anchor" href="#-8" aria-hidden="true">🔗</a></h4>
<p>斜切可以造成类似矩形变形为平行四边形的效果。</p>
<ul>
<li>skewX：横向斜切</li>
<li>skewY：纵向斜切</li>
</ul>
<h2 id="-9">对象容器 <a class="header-anchor" href="#-9" aria-hidden="true">🔗</a></h2>
<p><code>DisplayObjectContainer</code> 是 <code>DisplayObject</code> 的子类。</p>
<p>向 Container 中添加 DisplayObject：</p>
<pre><code class="language-js">container.addChild(displayObject);
</code></pre>
<blockquote>
<p>同一个显示对象无论被代码加入显示列表多少次，在屏幕上只绘制一次。如果一个显示对象 A 被添加到了 B 这个容器中，然后 A 又被添加到了 C 容器中。那么在第二次执行 C.addChild(A) 的时候，A 自动的从 B 容器中被删除，然后添加到 C 容器中。</p>
</blockquote>
<p>移除：</p>
<pre><code class="language-js">container.removeChild(displayObject);
</code></pre>
<h3 id="-10">深度管理 <a class="header-anchor" href="#-10" aria-hidden="true">🔗</a></h3>
<p>DisplayObject 的 <code>z-index</code> 由其插入到容器中的顺序决定。后插入的显示在上层。</p>
<p>插入到指定位置使用 <code>container.addChildAt(object, index)</code> 方法。</p>
<p>同时也有 <code>container.removeChileAt(index)</code> 方法。</p>
<p>删除全部对象使用 <code>container.removeChildren()</code> 方法。</p>
<p>交换 DisplayObject 的位置有两个方法：</p>
<ul>
<li><code>container.swapChildren(object, object)</code></li>
<li><code>container.swapChildrenAt(index, index)</code></li>
</ul>
<p>手动设置 z-index 使用 <code>container.setChildIndex( object, index )</code> 方法。</p>
<h3 id="-11">子对象选择 <a class="header-anchor" href="#-11" aria-hidden="true">🔗</a></h3>
<p>通过 z-index 获取：<code>container.getChildAt(index)</code></p>
<p>通过 name 获取（需要预先给 DisplayObject 设置 name 属性）：<code>container.getChildByName(name)</code></p>
<blockquote>
<p>通过 z-index 获取子对象性能更佳。</p>
</blockquote>
<h2 id="-12">矢量绘图 <a class="header-anchor" href="#-12" aria-hidden="true">🔗</a></h2>
<blockquote>
<p>Egret中可以直接使用程序来绘制一些简单的图形，这些图形在运行时都会进行实时绘图。要进行绘图操作，我们需要使用 Graphics 这个类。但并非直接使用。 一些显示对象中已经包含了绘图方法，我们可以直接调用这些方法来进行绘图。 Graphics 中提供多种绘图方法。</p>
</blockquote>
<p>已有的绘图方法包括：矩形、圆形、直线、曲线、圆弧。</p>
<p>以下的 <code>shp</code> 代表 shape，即一个 Shape 对象的实例。</p>
<p><code>shp.graphics.clear()</code> 是通用的清楚绘图方法。</p>
<h3 id="-13">基本图形 <a class="header-anchor" href="#-13" aria-hidden="true">🔗</a></h3>
<h4 id="-14">矩形 <a class="header-anchor" href="#-14" aria-hidden="true">🔗</a></h4>
<pre><code class="language-js"><span class="hljs-keyword">var</span> shp:egret.Shape = <span class="hljs-keyword">new</span> egret.Shape();
shp.graphics.beginFill( <span class="hljs-number">0xff0000</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">//color and alpha</span>
shp.graphics.drawRect( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span> ); <span class="hljs-comment">// x y width height</span>
shp.graphics.lineStyle( <span class="hljs-number">10</span>, <span class="hljs-number">0x00ff00</span> ); <span class="hljs-comment">// border-width and border-color</span>
shp.graphics.endFill();
<span class="hljs-keyword">this</span>.addChild( shp );
</code></pre>
<h4 id="-15">圆形 <a class="header-anchor" href="#-15" aria-hidden="true">🔗</a></h4>
<pre><code class="language-js">shp.graphics.lineStyle( <span class="hljs-number">10</span>, <span class="hljs-number">0x00ff00</span> );
shp.graphics.beginFill( <span class="hljs-number">0xff0000</span>, <span class="hljs-number">1</span>);
shp.graphics.drawCircle( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span> ); <span class="hljs-comment">// x y r</span>
</code></pre>
<blockquote>
<p>此处需要注意的是，圆形的X轴和Y轴位置是相对于Shape对象的锚点计算的。</p>
</blockquote>
<h4 id="-16">直线 <a class="header-anchor" href="#-16" aria-hidden="true">🔗</a></h4>
<pre><code class="language-js">shp.graphics.lineStyle( <span class="hljs-number">2</span>, <span class="hljs-number">0x00ff00</span> );
shp.graphics.moveTo( <span class="hljs-number">10</span>,<span class="hljs-number">10</span> ); <span class="hljs-comment">// 起点</span>
shp.graphics.lineTo( <span class="hljs-number">100</span>, <span class="hljs-number">20</span> ); <span class="hljs-comment">// 终点（可以多次执行 lineTo）</span>
</code></pre>
<h4 id="-17">曲线 <a class="header-anchor" href="#-17" aria-hidden="true">🔗</a></h4>
<pre><code class="language-js">shp.graphics.lineStyle( <span class="hljs-number">2</span>, <span class="hljs-number">0x00ff00</span> );
shp.graphics.moveTo( <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
shp.graphics.curveTo( <span class="hljs-number">100</span>,<span class="hljs-number">100</span>, <span class="hljs-number">200</span>,<span class="hljs-number">50</span>); <span class="hljs-comment">// 控制点 x y ，终点 x y</span>
</code></pre>
<h4 id="-18">圆弧 <a class="header-anchor" href="#-18" aria-hidden="true">🔗</a></h4>
<pre><code class="language-js">drawArc( x:number, <span class="hljs-attr">y</span>:number, <span class="hljs-attr">radius</span>:number, <span class="hljs-attr">startAngle</span>:number, <span class="hljs-attr">endAngle</span>:number, <span class="hljs-attr">anticlockwise</span>:boolean ):<span class="hljs-keyword">void</span>
</code></pre>
<p>前面的参数跟前面绘制圆形的一样，圆弧路径的圆心在 (x, y) 位置，半径为 radius 。后面的参数表示根据 anticlockwise ： 如果为 true，逆时针绘制圆弧，反之，顺时针绘制。</p>
<blockquote>
<p>需要注意是传入的 startAngle 和 endAngle 均为弧度而不是角度。</p>
</blockquote>
<h2 id="-19">遮罩 <a class="header-anchor" href="#-19" aria-hidden="true">🔗</a></h2>
<p>DisplayObject 有一个 <code>mask</code> 属性，简单来说，就是类似蒙版上面的一个洞。但这个 <code>mask</code> 是洞而不是蒙版。如果添加了 <code>mask</code> 属性，则 Object 只能显示这个“洞中”的内容。</p>
<p>用作遮罩的显示对象可设置动画、动态调整大小。遮罩显示对象不一定需要添加到显示列表中。<strong>但是，如果希望在缩放舞台时也缩放遮罩对象，或者如果希望支持用户与遮罩对象的交互（如调整大小），则必须将遮罩对象添加到显示列表中</strong>。</p>
<blockquote>
<p>不能使用一个遮罩对象来遮罩另一个遮罩对象。</p>
</blockquote>
<p>通过将 mask 属性设置为 null 可以删除遮罩。</p>
<pre><code class="language-js">mySprite.mask = <span class="hljs-literal">null</span>;
</code></pre>
<h2 id="-20">碰撞检测 <a class="header-anchor" href="#-20" aria-hidden="true">🔗</a></h2>
<ul>
<li>非精确：<code>var isHit:boolean = shp.hitTestPoint( 10, 10 );</code></li>
<li>精确：<code>shp.hitTestPoint( 10, 10，ture);</code></li>
</ul>
<p>非精确大概可以看做面积相交，精确则是边缘相交。</p>
<blockquote>
<p>大量使用精确碰撞检测，会消耗更多的性能。</p>
</blockquote>
<h2 id="-21">文本 <a class="header-anchor" href="#-21" aria-hidden="true">🔗</a></h2>
<p>Egret 提供三种不同的文本类型，不同类型具有以下特点：</p>
<ul>
<li>普通文本：用于显示标准文本内容的文本类型</li>
<li>输入文本：允许用户输入的文本类型</li>
<li>位图文本：借助位图字体渲染的文本类型</li>
</ul>
<h3 id="-22">样式 <a class="header-anchor" href="#-22" aria-hidden="true">🔗</a></h3>
<pre><code class="language-js"><span class="hljs-keyword">var</span> label:egret.TextField = <span class="hljs-keyword">new</span> egret.TextField(); 
label.text = <span class="hljs-string">"这是一个文本"</span>;
label.size = <span class="hljs-number">20</span>; <span class="hljs-comment">// 全局默认值 egret.TextField.default_size，下同</span>
label.width = <span class="hljs-number">70</span>;
label.height = <span class="hljs-number">70</span>;
label.textAlign = egret.HorizontalAlign.RIGHT; <span class="hljs-comment">// CENTER LEFT</span>
label.verticalAlign = egret.VerticalAlign.BOTTOM; <span class="hljs-comment">// MIDDLE TOP</span>
label.fontFamily = <span class="hljs-string">"KaiTi"</span>; <span class="hljs-comment">// default_fontFamily</span>
label.textColor = <span class="hljs-number">0xff0000</span>; <span class="hljs-comment">// default_textColor</span>

<span class="hljs-comment">//设置粗体与斜体</span>
label.bold = <span class="hljs-literal">true</span>;
label.italic = <span class="hljs-literal">true</span>;

<span class="hljs-comment">//设置描边属性</span>
label.strokeColor = <span class="hljs-number">0x0000ff</span>;
label.stroke = <span class="hljs-number">2</span>;
<span class="hljs-keyword">this</span>.addChild( label );
</code></pre>
<p>支持格式混排：</p>
<pre><code class="language-js"><span class="hljs-comment">// JSON 模式</span>
label.textFlow = &lt;Array&lt;egret.ITextElement&gt;&gt;[
    {text: "妈妈再也不用担心我在", style: {"size": 12}}
    , {text: "Egret", style: {"textColor": 0x336699, "size": 60, "strokeColor": 0x6699cc, "stroke": 2}}
    , {text: "里说一句话不能包含各种", style: {"fontFamily": "楷体"}}
    , {text: "五", style: {"textColor": 0xff0000}}
    , {text: "彩", style: {"textColor": 0x00ff00}}
    , {text: "缤", style: {"textColor": 0xf000f0}}
    , {text: "纷", style: {"textColor": 0x00ffff}}
    , {text: "、\n"}
    , {text: "大", style: {"size": 36}}
    , {text: "小", style: {"size": 6}}
    , {text: "不", style: {"size": 16}}
    , {text: "一", style: {"size": 24}}
    , {text: "、"}
    , {text: "格", style: {"italic": true, "textColor": 0x00ff00}}
    , {text: "式", style: {"size": 16, "textColor": 0xf000f0}}
    , {text: "各", style: {"italic": true, "textColor": 0xf06f00}}
    , {text: "样", style: {"fontFamily": "楷体"}}
    , {text: ""}
    , {text: "的文字了！"}
];

// HTML 模式 （标签与属性部分支持）
label.textFlow = (new egret.HtmlTextParser).parser(
    '没有任何格式初始文本，' +
    '&lt;font color="#0000ff" size="30" fontFamily="Verdana"&gt;Verdana blue large&lt;/font&gt;' +
    '&lt;font color="#ff7f50" size="10"&gt;珊瑚色&lt;b&gt;局部加粗&lt;/b&gt;小字体&lt;/font&gt;' +
    '&lt;i&gt;斜体&lt;/i&gt;'
);
</code></pre>
<h3 id="-23">事件与链接 <a class="header-anchor" href="#-23" aria-hidden="true">🔗</a></h3>
<pre><code class="language-js">tx.textFlow = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>&lt;egret.ITextElement&gt;(
    { <span class="hljs-attr">text</span>:<span class="hljs-string">"这段文字有链接"</span>, <span class="hljs-attr">style</span>: { <span class="hljs-string">"href"</span> : <span class="hljs-string">"event:text event triggered"</span> } }
    ,{ <span class="hljs-attr">text</span>:<span class="hljs-string">"\n这段文字没链接"</span>, <span class="hljs-attr">style</span>: {} }
);
tx.touchEnabled = <span class="hljs-literal">true</span>;
tx.addEventListener( egret.TextEvent.LINK, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> evt:egret.TextEvent </span>)</span>{
    <span class="hljs-built_in">console</span>.log( evt.text );
}, <span class="hljs-keyword">this</span> );
</code></pre>
<p>也可以直接将 <code>href</code> 设置为 url，这样不需要事件监听，将直接打开链接。但<strong>只适用 Web 端</strong>。</p>
<h3 id="-24">文本输入 <a class="header-anchor" href="#-24" aria-hidden="true">🔗</a></h3>
<p>关键代码是设置其类型为 INPUT。</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> txInput:egret.TextField = <span class="hljs-keyword">new</span> egret.TextField;
txInput.type = egret.TextFieldType.INPUT;
</code></pre>
<p>绘制输入背景可以用其它 DisplayObject，目前没有内置实现。</p>
<p>获取焦点使用 <code>textIput.setFocus();</code> 方法。</p>
<p>除此以外，还有 <code>inputType</code> 属性表示输入内容的区别，这个主要用于移动端弹出相应的键盘。</p>
<h2 id="-25">事件处理 <a class="header-anchor" href="#-25" aria-hidden="true">🔗</a></h2>
<p>事件类：<code>egret.Event</code></p>
<h3 id="-26">执行流程 <a class="header-anchor" href="#-26" aria-hidden="true">🔗</a></h3>
<blockquote>
<p>事件机制包含4个步骤：注册侦听器，发送事件，侦听事件，移除侦听器。这四个步骤是按照顺序来执行的。</p>
</blockquote>
<h3 id="-27">事件类 <a class="header-anchor" href="#-27" aria-hidden="true">🔗</a></h3>
<p>其构建器可以传 3 个参数：事件类型、是否冒泡、是否可取消（什么是取消？）。</p>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">egret</span>.<span class="hljs-title">Event</span>
</span>{
    public <span class="hljs-keyword">static</span> DATE:string = <span class="hljs-string">"约会"</span>;
    public _year:number = <span class="hljs-number">0</span>;
    public _month:number = <span class="hljs-number">0</span>;
    public _date:number = <span class="hljs-number">0</span>;
    public _where:string = <span class="hljs-string">""</span>;
    public _todo:string = <span class="hljs-string">""</span>;
    public <span class="hljs-keyword">constructor</span>(type:string, bubbles:boolean=false, cancelable:boolean=false)
    {
        <span class="hljs-keyword">super</span>(type,bubbles,cancelable);
    }
}
</code></pre>
<h3 id="-28">监听器 <a class="header-anchor" href="#-28" aria-hidden="true">🔗</a></h3>
<p>跟常见的情况不太一样，Egret 的事件<strong>绑定在发送者上</strong>（而不是接收者）。</p>
<h4 id="-29">监听器函数 <a class="header-anchor" href="#-29" aria-hidden="true">🔗</a></h4>
<blockquote>
<p>一个侦听器必须是函数，它可以是一个独立函数，也可以是一个实例的方法。侦听器必须有一个参数，并且这个参数必须是 Event 类实例或其子类的实例， 同时，侦听器的返回值必须为空（void）。</p>
</blockquote>
<h4 id="-30">注册与移除事件监听 <a class="header-anchor" href="#-30" aria-hidden="true">🔗</a></h4>
<p>注册侦听器</p>
<pre><code class="language-js">eventDispatcher.addEventListener(eventType, listenerFunction, <span class="hljs-keyword">this</span>);
</code></pre>
<p>移除侦听器</p>
<pre><code class="language-js">eventDispatcher.removeEventListener(eventType, listenerFunction, <span class="hljs-keyword">this</span>);
</code></pre>
<p>检测侦听器</p>
<pre><code class="language-js">eventDispatcher.hasEventListener(eventType);
</code></pre>
<h4 id="-31">优先级 <a class="header-anchor" href="#-31" aria-hidden="true">🔗</a></h4>
<pre><code class="language-js">public addEventListener(type:string, <span class="hljs-attr">listener</span>:<span class="hljs-built_in">Function</span>, <span class="hljs-attr">thisObject</span>:any, <span class="hljs-attr">useCapture</span>:boolean = <span class="hljs-literal">false</span>, <span class="hljs-attr">priority</span>:number = <span class="hljs-number">0</span>)
</code></pre>
<blockquote>
<p>该属性为一个number类型，当数字越大，则优先级越大。在触发事件的时候优先级越高。</p>
</blockquote>
</div> <hr data-v-f233b600=""> <nav data-v-7144c3e4="" data-v-f233b600=""><ul data-v-7144c3e4="" class="pager"><li data-v-7144c3e4="" class="previous"><a data-v-7144c3e4="" href="/p/meanjs-5-x-ng-repeat-flashing" class=""><i data-v-7144c3e4="" class="glyphicon glyphicon-chevron-left"></i> MEAN.JS 在 0.5 版本下发现的 NG-REPEAT 闪动问题
      </a></li> <li data-v-7144c3e4="" class="next"><a data-v-7144c3e4="" href="/p/change-socks-proxy-to-http" class="">
        Change SOCKS Proxy to HTTP <i data-v-7144c3e4="" class="glyphicon glyphicon-chevron-right"></i></a></li></ul></nav> <hr data-v-f233b600=""> <div data-v-1a6fe007="" data-v-f233b600="" id="disqus_thread"><i data-v-1a6fe007="" class="glyphicon glyphicon-refresh icon-spin"></i> <span data-v-1a6fe007="">Loading Disqus......</span></div></section></section></div></div></div></div> <section data-v-f9dc3034="" data-v-79039cdb="" class="page-footer"><div data-v-f9dc3034="" class="container-fluid"><div data-v-f9dc3034="" class="row"><div data-v-f9dc3034="" class="col-xs-12"><p data-v-f9dc3034=""><span data-v-f9dc3034="">Links:</span> <!----> <a data-v-f9dc3034="" href="https://blog.aquariuslt.com/" target="_blank">Aquariuslt</a><span data-v-f9dc3034="">&nbsp;/</span> <a data-v-f9dc3034="" href="https://lz5z.com" target="_blank">Leo's Blog</a></p></div></div> <div data-v-f9dc3034="" class="row"><div data-v-f9dc3034="" class="col-xs-12"><a data-v-f9dc3034="" href="https://wxsm.space">© 2018 WXSM</a> <span data-v-f9dc3034="">/</span> <a data-v-f9dc3034="" href="/feed.xml" rel="nofollow" target="_blank">FEED</a> <span data-v-f9dc3034="">/</span> <a data-v-f9dc3034="" title="LICENSE" href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a></div></div></div></section></section></section>
<div id="nprogress" style="transition: none; -webkit-transition: none; opacity: 1;"><div class="bar" role="bar" style="transition: all 200ms ease; -webkit-transition: all 200ms ease; -webkit-transform: translate3d(0%, 0px, 0px);"><div class="peg"></div></div></div></body></html>
