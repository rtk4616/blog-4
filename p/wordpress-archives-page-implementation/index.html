<!DOCTYPE html><html class="nprogress-busy"><head><meta charset="utf-8"><meta name="google-site-verification" content="ekuL5J7xK1IdFtP13v3KxpuGKnYS1oCT9PvZdjYm8Eg"><meta name="viewport" content="user-scalable=no,width=device-width,initial-scale=1,maximum-scale=1"><link rel="shortcut icon" type="image/png" href="/static/favicon.png"><link rel="apple-touch-icon" sizes="200x200" href="/static/favicon-iphone.png"><title>wxsm's space - WordPress æ–‡ç« å½’æ¡£é¡µé¢å®ç°</title><meta name="description" content="wxsms's personal blog."><meta name="keywords" content="Blog,JavaScript,HTML,CSS,Vue,Bootstrap"><link href="/static/css/app.c460d3b13d6d7ce0c63faa74a9023a8f.css" rel="stylesheet"><script type="text/javascript" src="/static/js/manifest.68263eefe155d055bfa0.js"></script><script type="text/javascript" src="/static/js/vendor.19a2875ac58b9bf76cc9.js"></script><script type="text/javascript" src="/static/js/app.6317672e36f60ab5ad32.js"></script><script async="" src="https://www.google-analytics.com/analytics.js" charset="utf8"></script><script async="" src="https://www.google-analytics.com/analytics.js" charset="utf8"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/0.24af7fe1e27d3b16bd28.js"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/4.f6eaab3002dc8add016f.js"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/0.24af7fe1e27d3b16bd28.js"></script><script type="text/javascript" charset="utf-8" async="" src="/static/js/1.3d038e42bb029d58fb1c.js"></script><script type="text/javascript" async="" id="embed-disqus" data-timestamp="1539144407528" src="//wxsm.disqus.com/embed.js"></script></head><body><section id="app"><section data-v-6a2c05ce="" style="display: none;"></section> <aside data-v-0044a876="" class=""><div data-v-0044a876="" class="brand"><h4 data-v-0044a876="" class="brand-link"><a data-v-0044a876="" href="/" class="router-link-active">wxsm's space</a></h4></div> <div data-v-0044a876="" class="search-container"><form data-v-e01410e2="" data-v-0044a876="" class="form-inline search-form-box"><div data-v-e01410e2="" class="form-group"><input data-v-e01410e2="" type="search" placeholder="Search..." required="required" minlength="2" class="form-control"></div></form></div> <div data-v-0044a876="" class="nav-container"><div data-v-0044a876="" class="nav-div"><ul data-v-0044a876="" role="tablist" class="nav nav-pills nav-stacked"><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/p" class="router-link-active btn btn-link" role="button">Archive</a></li><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/t" class="btn btn-link" role="button">Tags</a></li><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/g" class="btn btn-link" role="button">Guestbook</a></li><li data-v-0044a876="" role="presentation"><a data-v-0044a876="" href="/a" class="btn btn-link" role="button">About</a></li></ul></div> <!----></div></aside> <section data-v-79039cdb="" class="page"><div data-v-79039cdb="" class="page-body"><button data-v-01aba251="" data-v-79039cdb="" type="button" class="navbar-toggle collapsed"><span data-v-01aba251="" class="sr-only">Toggle navigation</span> <span data-v-01aba251="" class="icon-bar"></span> <span data-v-01aba251="" class="icon-bar"></span> <span data-v-01aba251="" class="icon-bar"></span></button> <div data-v-79039cdb="" class="container-fluid"><div data-v-79039cdb="" class="row"><div data-v-79039cdb="" class="col-xs-12"><section data-v-f233b600="" data-v-79039cdb=""><h1 data-v-f233b600="">WordPress æ–‡ç« å½’æ¡£é¡µé¢å®ç°</h1> <section data-v-f233b600="" id="post-content"><section data-v-19e352bd="" data-v-f233b600=""><div data-v-19e352bd="" class="meta-block"><i data-v-19e352bd="" class="glyphicon glyphicon-calendar"></i> <span data-v-19e352bd="">February 2, 2016</span></div> <div data-v-19e352bd="" class="meta-block"><a data-v-3cd447cb="" data-v-19e352bd="" href="/t#MySQL" class="label-tag"><span data-v-3cd447cb="" class="label label-primary">MySQL</span></a><a data-v-3cd447cb="" data-v-19e352bd="" href="/t#PHP" class="label-tag"><span data-v-3cd447cb="" class="label label-info">PHP</span></a><a data-v-3cd447cb="" data-v-19e352bd="" href="/t#Wordpress" class="label-tag"><span data-v-3cd447cb="" class="label label-primary">Wordpress</span></a></div></section> <div data-v-f233b600=""><p>å½’æ¡£é¡µå°±æ˜¯ä¸€ä¸ªåŒ…å«ç«™ç‚¹æ‰€æœ‰å·²å‘å¸ƒæ–‡ç« çš„åˆ—è¡¨é¡µé¢ï¼Œé€šå¸¸é»˜è®¤ä¼šæ ¹æ®å‘å¸ƒæ—¶é—´æ¥è¿›è¡Œæ’åºï¼Œç„¶åå¯èƒ½ä¼šæœ‰ä¸€äº›åˆ†é¡µæ’åºé¡µå†…æœç´¢ç­‰åŠŸèƒ½ã€‚å®ç°è¿™ä¸ªåŠŸèƒ½å¯ä»¥ç”¨Wordpressæ’ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±å†™ä»£ç ï¼Œæˆ‘ä¸€å¼€å§‹å°±æ˜¯ç”¨äº†ä¸€æ¬¾æ’ä»¶ï¼Œè§‰å¾—å®ç°äº†åŠŸèƒ½è¿˜ä¸é”™å°±æ²¡ç®¡å®ƒã€‚åæ¥æƒ³è¦åšä¸€äº›è‡ªå®šä¹‰çš„ä¿®æ”¹ï¼Œæ¯”å¦‚æ’ä»¶æ˜¯æŒ‰æœˆä»½åˆ†ç»„ç„¶è€Œæˆ‘æƒ³æ”¹æˆå¹´ä»½ï¼Œå°±ç¨å¾®çœ‹äº†çœ‹å®ƒçš„ä»£ç ã€‚ä¸€çœ‹ä¸å¾—äº†ï¼Œè«ååœ°æœ‰ä¸€ç§æ€»ç®—è§è¯†åˆ°äº†ä»€ä¹ˆå«åˆçƒ‚åˆè‡­çš„ä»£ç çš„æ„Ÿè§‰æ¶Œä¸Šå¿ƒå¤´ï¼Œåšäº†è¿™ä¹ˆå¤šå¹´ä¼¸æ‰‹å…šæ€»ç®—æ˜¯è¢«æ¶å¿ƒåˆ°äº†ï¼Œç®€ç›´ä¸èƒ½å¿ï¼Œäºæ˜¯ç¢ç£¨ç€è‡ªå·±å†™ä¸€ä¸ªç®€å•çš„æ¨¡æ¿é¡µï¼Œä¸ç”¨å®ƒäº†ã€‚</p>
<!--more-->
<h2 id="">åæ§½åŒº <a class="header-anchor" href="#" aria-hidden="true">ğŸ”—</a></h2>
<p>é¦–å…ˆæ¥è¯´è¯´ä¸ºä»€ä¹ˆè¿™ä¸ªæ’ä»¶çš„ä»£ç <strong>åˆçƒ‚åˆè‡­</strong>ï¼Œåœ¨åé¢æˆ‘å†å¯¹å®ƒè¿›è¡Œé’ˆå¯¹æ€§çš„æ”¹è¿›ã€‚å“¦å¯¹äº†å®ƒçš„åå­—å«<strong>Clean Archives Reloaded</strong>ï¼Œä½œè€…å«<strong>Viper007Bond</strong>ï¼Œæ¥è‡ªç¾å›½ä¿„å‹’å†ˆå·ï¼Œæ²¡é”™å°±æ˜¯ç‚¹åæ‰¹è¯„ï¼Œçœ‹æ¥é¬¼ä½¬çš„ç¼–ç æ°´å¹³ä¹Ÿä¸æ˜¯æ™®éçš„é«˜å•Šï¼Œè¿™å¨å±ç®€ç›´æ˜¯å¼€æºç•Œçš„è€»è¾±ã€‚å»åˆ°å„æœç´¢å¼•æ“æœç´¢â€œWordpresså½’æ¡£â€å…³é”®å­—è¿˜æœ‰å¾ˆå¤šæ–‡ç« æ¨èä½¿ç”¨è¯¥æ’ä»¶ï¼Œçœ‹æ¥å¤§å®¶éƒ½ä¸å¤ªå…³å¿ƒä»£ç è´¨é‡ï¼Œåªè¦èƒ½ç”¨å°±è¡Œã€‚ è¯¥æ’ä»¶çš„ä¸»è¦è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä»WPæ•°æ®åº“ä¸­æŠ“å–æ–‡ç« </li>
<li>æ ¹æ®ç”¨æˆ·é…ç½®åˆ†ç»„å¹¶æ’åº</li>
<li>ç»„ç»‡å¹¶è¾“å‡ºHTMLåˆ°é¡µé¢ç›¸å…³ä½ç½®</li>
</ol>
<p>OKï¼Œå°±è¿™ä¹ˆä¸‰æ­¥ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¹Ÿåªéœ€è¦è¿™ä¹ˆç‚¹ä¸œè¥¿ã€‚æš‚ä¸”ä¸è®¨è®ºæ­¥éª¤æ˜¯å¦å¯ä»¥ç®€åŒ–ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒæœ‰ç€æ€æ ·çš„å†…å¿ƒä¸–ç•Œã€‚</p>
<pre><code>// A direct query is used instead of get_posts() for memory reasons
$rawposts = $wpdb-&gt;get_results( "SELECT ID, post_date, post_date_gmt, comment_status, comment_count FROM $wpdb-&gt;posts WHERE post_status = 'publish' AND post_type = 'post' AND post_password = ''" );

</code></pre>
<p>è¿™ä¸ªæ˜¯å®ƒçš„å”¯ä¸€ä¸€æ¡SQLè¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°ä½œè€…ä¸ºäº†ç»™æˆ‘ä»¬èŠ‚çœå†…å­˜çœŸæ˜¯æ®šç²¾ç«­åŠ›ï¼Œæœ¬ç€å¤Ÿç”¨å°±è¡Œçš„ç²¾ç¥ï¼Œæ”¾å¼ƒä½¿ç”¨Wordpressè‡ªå¸¦çš„APIï¼Œç›´æ¥ä½¿ç”¨æŸ¥è¯¢è¯­å¥ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ¥äº†éå¸¸æœ‰é™çš„ä¸€äº›å­—æ®µã€‚å€¼å¾—ç§°èµã€‚ æŒ‰ç…§æ’ä»¶çš„æ€è·¯ï¼Œç´§æ¥ç€å°±æ˜¯åˆ†ç»„å•¦ï¼š</p>
<pre><code>// Loop through each post and sort it into a structured array
foreach( $rawposts as $post ) {
	$posts[ mysql2date( 'Y.m', $post-&gt;post_date ) ][] = $post;
}
$rawposts = null; // More memory cleanup
</code></pre>
<p>æ’åºå•¦ï¼š</p>
<pre><code>( 'new' == $atts['monthorder'] ) ? krsort( $posts ) : ksort( $posts );

// Sort the posts within each month based on $atts
foreach( $posts as $key =&gt; $month ) {
    $sorter = array();
    foreach ( $month as $post )
        $sorter[] = $post-&gt;post_date_gmt;

    $sortorder = ( 'new' == $atts['postorder'] ) ? SORT_DESC : SORT_ASC;

    array_multisort( $sorter, $sortorder, $month );

    $posts[$key] = $month;
    unset($month);
}
</code></pre>
<p>åˆ†ç»„çš„æ€è·¯å°±æ˜¯æ ¹æ®ä¸€ç¯‡æ–‡ç« çš„å¹´ä»¥åŠæœˆæ¥å°†åŸæœ¬çš„ä¸€ç»´æ•°ç»„é‡æ–°ç»„ç»‡åˆ°ä¸€ä¸ªæ–°çš„äºŒç»´æ•°ç»„ä¸­å»ï¼Œä»¥æ–¹ä¾¿åé¢çš„å¾ªç¯ã€‚æ’åºæœ‰ç‚¹å¤æ‚ï¼Œé¦–å…ˆå¤§å±€ä¸Šå®ƒæ˜¯èƒ½å¤Ÿæ ¹æ®é…ç½®æŒ‰æœˆä»½ä»æ–°åˆ°æ—§æˆ–è€…åæ–¹å‘çš„æ’åºï¼Œç„¶ååœ¨æ¯ä¸ªæœˆä»½é‡Œé¢ä¹Ÿèƒ½å¤Ÿæ ¹æ®é…ç½®ä»æ–°åˆ°æ—§æˆ–è€…åæ–¹å‘çš„æ’åºï¼Œè¿™ä¸ªè®¾å®šç®€ç›´è›‹ç–¼ï¼Œè°è¿™ä¹ˆæ— èŠæ­£ç€æ’ä¸€éåœ¨é‡Œé¢åç€åˆæ’ä¸€éï¼Œå³æŠ˜ç£¨è‡ªå·±åˆæŠ˜ç£¨è¯»è€…ï¼Œä¸è¿‡å­˜åœ¨å³åˆç†ï¼Œè¿™é‡Œä¹Ÿä¸è¯´å®ƒã€‚**æˆ‘æƒ³åæ§½çš„æ˜¯ï¼Œæ—¢ç„¶ä½ éƒ½æŠŠSQLå†™å‡ºæ¥äº†ï¼Œä½ ä¹ŸçŸ¥é“è‡³å°‘è¦æ’ä¸€æ¬¡åºäº†ï¼Œåˆä½•å¿…è´¹å°½å‘¨ç« åœ¨æŸ¥å‡ºæ¥ä»¥åæ’å‘¢ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨SQLé‡Œé¢æ’ä¸æ¯”è¿™ä¸€å¤§ä¸²ä»£ç ä¼˜é›…å—ï¼Ÿä¸å¿«é€Ÿå—ï¼Ÿä¸èŠ‚çœå†…å­˜å—ï¼Ÿæ­¤å¤–ï¼Œè¿™ä¸ªåˆ†ç»„ä¹Ÿæ˜¯èŒèŒå“’ï¼Œæˆ‘ä»¬å°±ä¸èƒ½åœ¨SQLé‡Œé¢å…ˆæŠŠç»„ç»™åˆ†å¥½å—ï¼Œéè¦å†™ä¸ªå¾ªç¯æ¥è°ƒç”¨&nbsp;**<code>mysql2date</code>ï¼Œè¿™æ ·çœŸçš„å¥½å—ï¼Ÿå½“ç„¶å¦‚æœä½œè€…æ²¡æœ‰å­¦è¿‡&nbsp;<code>ORDER BY</code>ï¼Œä¹Ÿä¸çŸ¥é“SQLéƒ½æœ‰å„è‡ªçš„å†…ç½®æ—¥æœŸå‡½æ•°ï¼Œè¿™äº›ä¹Ÿå°±ç®—äº†ã€‚æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚ æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯ç»„ç»‡HTMLï¼š</p>
<pre><code>// Generate the HTML
$html = '&lt;div class="car-container';
if ( 1 == $atts['usejs'] ) $html .= ' car-collapse';
$html .= '"&gt;'. "\n";

// æ­¤å¤„çœç•¥nè¡Œ

$html .= "&lt;/ul&gt;\n&lt;/div&gt;\n";
return $html;
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œæˆ‘å·²ç»çäº†ã€‚ã€‚ã€‚å°¤å…¶æ˜¯é«˜äº®çš„é‚£ä¸€è¡Œã€‚ã€‚ã€‚çœç•¥çš„Nè¡Œä¸­å……æ–¥ç€çš„éƒ½æ˜¯å¦‚æ­¤çš„ä»£ç ã€‚å®ƒè¿˜ä¸æ­¢æœ‰&nbsp;<code>. "\n"</code>&nbsp;ä¹‹æµï¼Œåœ¨çœç•¥çš„å†…å®¹ä¸­ç”šè‡³è¿HTMLçš„ç¼–ç å™¨ç¼©è¿›ä½œè€…éƒ½ä¿ç•™å¾—å¾ˆå¥½å¾ˆå¥½ã€‚WTFï¼Ÿï¼Ÿè¿™TMéƒ½æ˜¯äº›ä»€ä¹ˆé¬¼ï¼Ÿï¼Ÿä½œè€…çš„è¿™äº›æ Nå’Œç¼©è¿›æ˜¯å†™ç»™é¬¼çœ‹çš„å—ï¼Ÿï¼Ÿï¼Ÿå­—ç¬¦ä¸²æ‹¼å‡‘å„ç§å†…å®¹è¿™ç§äº‹æˆ‘è‡ªå·±ä¸æ‡‚äº‹çš„æ—¶å€™ä¹Ÿå¹²è¿‡ä¸å°‘ä¹Ÿå°±ä¸è¯´äº†ï¼Œä½†è¿™ä½œè€…è¿™ä¸€ç§åŸæ±åŸå‘³çš„æ‹¼æ³•çœŸæ˜¯æˆ‘æœ‰å±ä»¥æ¥è§è¿‡çš„æœ€ç‰¹ç«‹ç‹¬è¡Œçš„è¡Œä¸ºè‰ºæœ¯ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥ç€æ¥çœ‹ç”ŸæˆHTMLä¹‹ä¸­çš„ä¸€éƒ¨åˆ†æ ¸å¿ƒä»£ç ã€‚æ˜¾ç„¶å…¶ä¸­ä¼šæœ‰ä¸€äº›å¾ªç¯ç”¨æ¥ç”Ÿæˆåˆ—è¡¨ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªå†…å±‚å¾ªç¯ä¹‹å‰åº”è¯¥è¾“å‡ºä¸€ä¸ªæ ‡é¢˜ä¹‹ç±»çš„ä¸œè¥¿ç”¨æ¥æŒ‡ç¤ºä»¥ä¸‹çš„å†…å®¹å±äºå“ªä¸€å¹´å“ªä¸€ä¸ªæœˆã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>$firstmonth = TRUE;
foreach( $posts as $yearmonth =&gt; $posts ) {
    list( $year, $month ) = explode( '.', $yearmonth );

    $firstpost = TRUE;
    foreach( $posts as $post ) {
        if ( TRUE == $firstpost ) {
            $html .= '	&lt;li&gt;&lt;span class="car-yearmonth"&gt;' . sprintf( __('%1$s %2$d'), $wp_locale-&gt;get_month($month), $year );
            if ( '0' != $atts['postcount'] ) $html .= ' &lt;span title="' . __('Post Count', 'clean-archives-reloaded') . '"&gt;(' . count($posts) . ')&lt;/span&gt;';
            $html .= "&lt;/span&gt;\n		&lt;ul class='car-monthlisting'&gt;\n";
            $firstpost = FALSE;
        }

        $html .= '			&lt;li&gt;' .  mysql2date( 'd', $post-&gt;post_date ) . ': &lt;a href="' . get_permalink( $post-&gt;ID ) . '"&gt;' . get_the_title( $post-&gt;ID ) . '&lt;/a&gt;';

        // Unless comments are closed and there are no comments, show the comment count
        if ( '0' != $atts['commentcount'] &amp;&amp; ( 0 != $post-&gt;comment_count || 'closed' != $post-&gt;comment_status ) )
            $html .= ' &lt;span title="' . __('Comment Count', 'clean-archives-reloaded') . '"&gt;(' . $post-&gt;comment_count . ')&lt;/span&gt;';

        $html .= "&lt;/li&gt;\n";
    }

    $html .= "		&lt;/ul&gt;\n	&lt;/li&gt;\n";
}
</code></pre>
<p>ç¬¬5-12è¡Œä»£ç ï¼Œç¬¬ä¸€çœ¼çœ‹åˆ°çš„æ—¶å€™é©¬ä¸Šå°±èƒ½é—»åˆ°ä¸€è‚¡å¼±è€…çš„æ°”æ¯ã€‚<strong>ä½œè€…æƒ³è¦åœ¨å¾ªç¯å¼€å§‹ä¹‹å‰å…ˆè¾“å‡ºä¸€ä¸ªåˆ—è¡¨æ ‡é¢˜ï¼Œæ‰€ä»¥æƒ³åˆ°äº†ä¸€ä¸ªä½¿ç”¨æ ‡å¿—ä½çš„åŠæ³•ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜æ˜å¯ä»¥ç›´æ¥åœ¨å¾ªç¯å‰é¢åšè¿™ä»¶äº‹çš„ï¼Œæ ¹æœ¬ä¸éœ€è¦è¿™ä¸ªèŒèŒå“’æ ‡å¿—ä½ã€‚</strong></p>
<p>è¿˜æœ‰ç¬¬14è¡Œã€‚ä½œè€…æ˜æ˜ä¸€ç›´åœ¨æ ‡æ¦œè‡ªå·±æ˜¯å¦‚ä½•èŠ‚çœæ—¶é—´èŠ‚çœå†…å­˜çš„ï¼Œç»“æœåœ¨è¿™é‡Œå´ä½¿ç”¨äº†å†…ç½®å‡½æ•°&nbsp;<code>get_the_title</code>&nbsp;ä»¥åŠ&nbsp;<code>get_permalink</code>ï¼Œåè€…å¾ˆæ­£å¸¸ï¼Œå› ä¸º wordpress çš„æ–‡ç« é“¾æ¥æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œä¸èƒ½ç›´æ¥å†™æ­»ï¼Œå¿…é¡»æŸ¥ï¼Œé‚£å‰è€…è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿå¾ˆæ˜æ˜¾ï¼Œæ ¹æ®ä¸€ç¯‡æ–‡ç« çš„ ID æ¥è·å–å®ƒçš„æ ‡é¢˜ã€‚è¦å¦‚ä½•æ ¹æ® ID æ¥è·å–æ ‡é¢˜å‘¢ï¼Œæˆ‘ä»¬èƒ½ç”¨ç®—æ³•ç®—å‡ºæ¥å—ï¼Ÿæ˜¾ç„¶ä¸èƒ½ï¼Œè¿™é‡Œé¢æ˜¾ç„¶éœ€è¦ä¸€æ¬¡æ•°æ®åº“æŸ¥è¯¢ï¼Œè‡³å°‘ä¹Ÿæ˜¯ä¸€æ¬¡ç¼“å­˜æŸ¥è¯¢ï¼Œè€Œä¸”å®ƒè¿™ä¸ªå‡½æ•°å†™åœ¨å¾ªç¯é‡Œé¢ï¼Œæˆ‘çš„å¤©ï¼Œè¿™é‡Œé¢æ˜¯å¤šå°‘æ¡ SQLï¼Œä½ ç›´æ¥åœ¨ä¸€å¼€å§‹æŠŠ Title ä¹Ÿç»™æŸ¥å‡ºæ¥ä¸å°±ä¸‡äº‹å¤§å‰äº†å—ã€‚ã€‚ã€‚</p>
<p>æ’ä»¶çš„æ ¸å¿ƒåŠŸèƒ½å¤§æ¦‚å°±åˆ°æ­¤ä¸ºæ­¢ï¼Œä¸ºäº†å®ç°è®©ç”¨æˆ·å¯ä»¥ç‚¹å‡»æ”¶èµ·ä¸å±•å¼€æ¯ä¸ªå†…å±‚åˆ—è¡¨çš„åŠŸèƒ½ï¼Œä½œè€…è¿˜æ·»åŠ äº†ä¸€äº› JavaScript ä»£ç ï¼Œå°±ä¸åæ§½äº†å§ï¼Œæˆ‘å·²ç»å¥½ç´¯äº†ã€‚</p>
<h2 id="-2">æ”¹è¿› <a class="header-anchor" href="#-2" aria-hidden="true">ğŸ”—</a></h2>
<p>èµ¶ç´§æŠŠè¿™æ’ä»¶åˆ äº†ï¼Œåˆ ä¸ªå¹²å‡€ï¼Œç„¶åæˆ‘ä»¬æ¥æ”¹ä»£ç ã€‚å› ä¸ºæˆ‘å¹¶ä¸éœ€è¦é…ç½®ä»€ä¹ˆä»€ä¹ˆçš„ï¼Œä¹Ÿä¸éœ€è¦ä»€ä¹ˆJSï¼Œæ€ä¹ˆä¸ªåˆ†ç»„æ€ä¹ˆä¸ªæ’åºçš„éœ€æ±‚å¾ˆæ˜ç¡®ï¼Œæ‰€ä»¥ç›´æ¥ HARD CODEã€‚åŸæ’ä»¶è¿˜æœ‰ä¸€ä¸ªç¼“å­˜æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®çš„åŠŸèƒ½ï¼Œç”±äºæˆ‘å·²ç»ç”¨äº†æ›´å¼ºå¤§çš„ç¼“å­˜ï¼Œç›´æ¥å°†åŠ¨æ€é¡µé¢ç¼“å­˜æˆçº¯ HTMLï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦ã€‚ä»¥ä¸Šå†…å®¹é€šé€šç æ‰ï¼Œæ ¸å¿ƒä»£ç å°±å¾ˆç®€å•äº†ã€‚ é¦–å…ˆæ˜¯ SQL æŸ¥è¯¢ï¼š</p>
<pre><code>global $wpdb;
$rawposts = $wpdb-&gt;get_results("SELECT ID, year(post_date) as post_year, post_date, post_date_gmt, post_title FROM $wpdb-&gt;posts WHERE post_status = 'publish' AND post_type = 'post' AND post_password = '' order by post_date_gmt desc");
</code></pre>
<p>è¿™é‡ŒæŒ‰ç…§å‘å¸ƒæ—¶é—´é™åºæ’åºï¼Œä¸ºä»€ä¹ˆè¦ç”¨GMTæ—¶é—´è€Œä¸ç›´æ¥ç”¨æœ¬åœ°æ—¶é—´å‘¢ï¼Œæˆ‘çŒœå¯èƒ½æ˜¯ä¸ºäº†é˜²æ­¢æˆ‘åœ¨è¿™è¾¹å‘äº†ä¸€ç¯‡æ–‡ç« ç„¶åé©¬ä¸Šé£åˆ°ç¾å›½åˆå‘ä¸€ç¯‡ï¼Œå¯èƒ½ä¼šä¹±å¥—å§ï¼Œåæ­£è¿™ä¹ˆå†™æ›´ä¸¥è°¨ï¼Œè™½ç„¶ä¸å¤ªå¯èƒ½å‘ç”Ÿã€‚ç„¶åé™¤äº†å¤šé€‰æ‹©ä¸€ä¸ªpost_titleå­—æ®µä»¥å¤–ï¼Œè¿˜ä½¿ç”¨MySQLçš„ä¸€ä¸ªå†…ç½®å‡½æ•°é€‰æ‹©äº†è¿™ç¯‡æ–‡ç« å‘å¸ƒæ—¶çš„å¹´åº¦ï¼Œè¿™æ ·å°±ä¸ç”¨åœ¨åˆ†ç»„çš„æ—¶å€™ä½¿ç”¨Nå¤šé&nbsp;<code>mysql2date</code>&nbsp;å‡½æ•°äº†ã€‚èŠ‚çœäº†å¤§é‡æ­¥éª¤ã€‚ ç„¶åæ˜¯åˆ†ç»„ï¼š</p>
<pre><code>foreach ($rawposts as $post) {
    $posts[$post-&gt;post_year][] = $post;
}
$rawposts = null;
</code></pre>
<p>ç„¶åæ˜¯HTMLéƒ¨åˆ†ï¼š</p>
<pre><code>$html = '&lt;div class="archives-container"&gt;&lt;ul class="archives-list"&gt;';
foreach ($posts as $year =&gt; $posts_yearly) {
    $html .= '&lt;li&gt;&lt;div class="archives-year"&gt;' . $year . 'å¹´&lt;/div&gt;&lt;ul class="archives-sublist"&gt;';
    foreach ($posts_yearly as $post) {
        $html .= '&lt;li&gt;';
        $html .= '&lt;time datetime="' . $post-&gt;post_date . '"&gt;' . mysql2date('mæœˆdæ—¥ D', $post-&gt;post_date, true) . '&lt;/time&gt;';
        $html .= '&lt;a href="' . get_permalink($post-&gt;ID) . '"&gt;' . $post-&gt;post_title . '&lt;/a&gt;';
        $html .= "&lt;/li&gt;";
    }
    $html .= "&lt;/ul&gt;&lt;/li&gt;";
}
$html .= "&lt;/ul&gt;&lt;/div&gt;";
return $html;
</code></pre>
<p>ä¸¤ä¸ªå­—ï¼šç®€æ´ã€‚</p>
<h2 id="-3">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#-3" aria-hidden="true">ğŸ”—</a></h2>
<p>æˆ‘ä»¬å¤åˆ¶ä¸€ä»½ä¸»é¢˜ç›®å½•ä¸‹çš„&nbsp;<code>page.php</code>&nbsp;æ–‡ä»¶ï¼Œç„¶åé‡å‘½åä¸º&nbsp;<code>template-archives.php</code>ï¼Œä¸»è¦æ˜¯ç»™å®ƒåŠ ä¸Šä»¥ä¸Šçš„ä»£ç å¹¶ä¸”è°ƒç”¨ä¹‹ã€‚ å¯¹äºæˆ‘æ­£åœ¨ä½¿ç”¨çš„ä¸»é¢˜æ¥è¯´ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code>&lt;?php
/*
Template Name: archives
*/


function _PostList($atts = array())
{
    global $wpdb;
    $rawposts = $wpdb-&gt;get_results("SELECT ID, year(post_date) as post_year, post_date, post_title FROM $wpdb-&gt;posts WHERE post_status = 'publish' AND post_type = 'post' AND post_password = '' order by post_date desc");
    foreach ($rawposts as $post) {
        $posts[$post-&gt;post_year][] = $post;
    }
    $rawposts = null;
    $html = '&lt;div class="archives-container"&gt;&lt;ul class="archives-list"&gt;';
    foreach ($posts as $year =&gt; $posts_yearly) {
        $html .= '&lt;li&gt;&lt;div class="archives-year"&gt;' . $year . 'å¹´&lt;/div&gt;&lt;ul class="archives-sublist"&gt;';
        foreach ($posts_yearly as $post) {
            $html .= '&lt;li&gt;';
            $html .= '&lt;time datetime="' . $post-&gt;post_date . '"&gt;' . mysql2date('mæœˆdæ—¥ D', $post-&gt;post_date, true) . '&lt;/time&gt;';
            $html .= '&lt;a href="' . get_permalink($post-&gt;ID) . '"&gt;' . $post-&gt;post_title . '&lt;/a&gt;';
            $html .= "&lt;/li&gt;";
        }
        $html .= "&lt;/ul&gt;&lt;/li&gt;";
    }
    $html .= "&lt;/ul&gt;&lt;/div&gt;";
    return $html;
}

function _PostCount()
{
    $num_posts = wp_count_posts('post');
    return number_format_i18n($num_posts-&gt;publish);
}

get_header(); ?&gt;

    &lt;div id="primary" class="content-area"&gt;
        &lt;main id="main" class="site-main" role="main"&gt;

            &lt;article &lt;?php post_class(); ?&gt;&gt;
                &lt;header class="entry-header"&gt;
                    &lt;h1 class="entry-title"&gt;&lt;?php the_title(); ?&gt;&lt;/h1&gt;
                &lt;/header&gt;
                &lt;!-- .entry-header --&gt;

                &lt;div class="entry-content"&gt;
                    &lt;?php
                    echo _PostList();
                    ?&gt;
                &lt;/div&gt;
                &lt;!-- .entry-content --&gt;
            &lt;/article&gt;
            &lt;!-- #post-## --&gt;


        &lt;/main&gt;
        &lt;!-- #main --&gt;
    &lt;/div&gt;
    &lt;!-- #primary --&gt;

&lt;?php get_sidebar(); ?&gt;
&lt;?php get_footer(); ?&gt;
</code></pre>
<p>ç„¶åæˆ‘ä»¬æŠŠå®ƒä¸Šä¼ åˆ°ä¸»æœºçš„ä¸»é¢˜ç›®å½•ä¸‹ï¼Œæ¥åˆ°wordpressç®¡ç†æ§åˆ¶å°æ–°å»ºä¸€ä¸ªpageï¼Œæ¨¡æ¿é€‰æ‹©&nbsp;<code>archives</code>ï¼Œä»€ä¹ˆä¹Ÿä¸ç”¨è¾“å…¥ï¼ˆå¯ä»¥åŠ ä¸ªæ ‡é¢˜ï¼‰ï¼Œä¿å­˜ï¼Œå°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚å½“ç„¶è¿™é‡Œæ²¡æœ‰æ¶‰åŠåˆ°CSSæ ·å¼ï¼Œå¯ä»¥åœ¨ä¸»é¢˜çš„&nbsp;<code>style.css</code>&nbsp;ä¸­è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™åœ¨&nbsp;<code>template-archives.php</code>&nbsp;å†…ï¼Œçˆ±å†™å“ªå†™å“ªã€‚æœ¬ç«™ä½¿ç”¨çš„CSSå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>.archives-year {
    color: #777;
    border-bottom: 1px solid #e8e8e8;
    margin: 40px 0 10px 0;
    padding-bottom: 7px;
}

.archives-list {
    list-style: none;
    margin: 20px 0!important;
}

.archives-sublist {
    list-style: none;
    font-size: 90%;
    margin-left: 0 !important;
}

.archives-sublist li time {
    color: #777;
    width: 140px;
    min-width: 140px;
    max-width: 140px;
    display: table-cell;
    vertical-align: top;
}

.archives-sublist li a {
    display: table-cell;
    vertical-align: top;
}
</code></pre>
<p><a href="http://anubarak.com/archives/">ç‚¹æ­¤æŸ¥çœ‹å®é™…æ•ˆæœ</a>&nbsp;ï¼ˆå¯èƒ½å› ä¸ºç½‘ç«™æ›´æ–°è€Œä¸ç¬¦åˆï¼‰</p>
</div> <hr data-v-f233b600=""> <nav data-v-7144c3e4="" data-v-f233b600=""><ul data-v-7144c3e4="" class="pager"><li data-v-7144c3e4="" class="previous"><a data-v-7144c3e4="" href="/p/angular-router-note" class=""><i data-v-7144c3e4="" class="glyphicon glyphicon-chevron-left"></i> Angular Router å­¦ä¹ ç¬”è®°
      </a></li> <li data-v-7144c3e4="" class="next"><a data-v-7144c3e4="" href="/p/using-idea-to-config-ftp-auto-deployment" class="">
        ä½¿ç”¨ IDEA é…ç½®è‡ªåŠ¨åŒæ­¥åˆ°FTPæœåŠ¡å™¨ <i data-v-7144c3e4="" class="glyphicon glyphicon-chevron-right"></i></a></li></ul></nav> <hr data-v-f233b600=""> <div data-v-1a6fe007="" data-v-f233b600="" id="disqus_thread"><i data-v-1a6fe007="" class="glyphicon glyphicon-refresh icon-spin"></i> <span data-v-1a6fe007="">Loading Disqus......</span></div></section></section></div></div></div></div> <section data-v-f9dc3034="" data-v-79039cdb="" class="page-footer"><div data-v-f9dc3034="" class="container-fluid"><div data-v-f9dc3034="" class="row"><div data-v-f9dc3034="" class="col-xs-12"><p data-v-f9dc3034=""><span data-v-f9dc3034="">Links:</span> <!----> <a data-v-f9dc3034="" href="https://blog.aquariuslt.com/" target="_blank">Aquariuslt</a><span data-v-f9dc3034="">&nbsp;/</span> <a data-v-f9dc3034="" href="https://lz5z.com" target="_blank">Leo's Blog</a></p></div></div> <div data-v-f9dc3034="" class="row"><div data-v-f9dc3034="" class="col-xs-12"><a data-v-f9dc3034="" href="https://wxsm.space">Â© 2018 WXSM</a> <span data-v-f9dc3034="">/</span> <a data-v-f9dc3034="" href="/feed.xml" rel="nofollow" target="_blank">FEED</a> <span data-v-f9dc3034="">/</span> <a data-v-f9dc3034="" title="LICENSE" href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a></div></div></div></section></section></section>
<div id="nprogress" style="transition: all 200ms linear; -webkit-transition: all 200ms linear; opacity: 0;"><div class="bar" role="bar" style="transition: all 200ms ease; -webkit-transition: all 200ms ease; -webkit-transform: translate3d(0%, 0px, 0px);"><div class="peg"></div></div></div></body></html>
